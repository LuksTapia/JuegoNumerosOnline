@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{

    <body>

    Jugador1: @ViewBag.Nombre1;
    Jugador2: @ViewBag.Nombre2;
    

    <div class="contenedor">
      <div class="botonera">
        <button id="b1" onclick="Jugar()"></button
        ><button id="b2" onclick="Jugar()"></button
        ><button id="b3" onclick="Jugar()"></button><br />
        <button id="b4" onclick="Jugar()"></button
        ><button id="b5" onclick="Jugar()"></button
        ><button id="b6" onclick="Jugar()"></button><br />
        <button id="b7" onclick="Jugar()"></button
        ><button id="b8" onclick="Jugar()"></button
        ><button id="b9" onclick="Jugar()"></button><br />
      </div>

      <div class="contiene-boton">
        <button onclick="InicializarJuego()" class="boton-Iniciar">
          INICIAR
        </button>
      </div>
    </div>

    <style>
      .contenedor {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
      }

      .boton-Iniciar {
        font-size: 10px;
        margin-top: 10px;
      }

      .pintarBoton {
        background-color: red;
      }
    </style>

    <script>
      var turno = "X";
      var hayGanador = false;


      function InicializarJuego() {
        turno = "X";
        hayGanador=false;
        for (i = 1; i <= 9; i++) {
          let boton = document.getElementById("b" + i);
          boton.value = "-";
          boton.innerHTML = boton.value;
          boton.classList.remove("pintarBoton");
        }
      }

      function Jugar(evt) {
        let boton = event.target;
        if (!hayGanador){
        if (boton.value == "-") {
          boton.value = turno;
          boton.innerHTML = boton.value;
          if (AnalizarSiGanoQuienToco()) {
            let ganador = notificarGanador(turno);
            alert("Gano " + ganador);
            hayGanador=true;
          } else {
            if (turno == "X") {
              turno = "O";
            } else {
              turno = "X";
            }
          }
        }}
      }

      function AnalizarSiGanoQuienToco() {
        var b1 = document.getElementById("b1").innerHTML;
        var b2 = document.getElementById("b2").innerHTML;
        var b3 = document.getElementById("b3").innerHTML;
        var b4 = document.getElementById("b4").innerHTML;
        var b5 = document.getElementById("b5").innerHTML;
        var b6 = document.getElementById("b6").innerHTML;
        var b7 = document.getElementById("b7").innerHTML;
        var b8 = document.getElementById("b8").innerHTML;
        var b9 = document.getElementById("b9").innerHTML;

        gano1 = verificarEnLinea(b1, b2, b3);
        gano2 = verificarEnLinea(b4, b5, b6);
        gano3 = verificarEnLinea(b7, b8, b9);
        gano4 = verificarEnLinea(b1, b4, b7);
        gano5 = verificarEnLinea(b2, b5, b8);
        gano6 = verificarEnLinea(b3, b6, b9);
        gano7 = verificarEnLinea(b1, b5, b9);
        gano8 = verificarEnLinea(b7, b5, b3);

        ganoAlguien =
          gano1 || gano2 || gano3 || gano4 || gano5 || gano6 || gano7 || gano8;

        if (ganoAlguien) {
          if (gano1) {
            document.getElementById("b1").classList.add("pintarBoton");
            document.getElementById("b2").classList.add("pintarBoton");
            document.getElementById("b3").classList.add("pintarBoton");
          } else if (gano2) {
            document.getElementById("b4").classList.add("pintarBoton");
            document.getElementById("b5").classList.add("pintarBoton");
            document.getElementById("b6").classList.add("pintarBoton");
          } else if (gano3) {
            document.getElementById("b7").classList.add("pintarBoton");
            document.getElementById("b8").classList.add("pintarBoton");
            document.getElementById("b9").classList.add("pintarBoton");
          } else if (gano4) {
            document.getElementById("b1").classList.add("pintarBoton");
            document.getElementById("b4").classList.add("pintarBoton");
            document.getElementById("b7").classList.add("pintarBoton");
          } else if (gano5) {
            document.getElementById("b2").classList.add("pintarBoton");
            document.getElementById("b5").classList.add("pintarBoton");
            document.getElementById("b8").classList.add("pintarBoton");
          } else if (gano6) {
            document.getElementById("b3").classList.add("pintarBoton");
            document.getElementById("b6").classList.add("pintarBoton");
            document.getElementById("b9").classList.add("pintarBoton");
          } else if (gano7) {
            document.getElementById("b1").classList.add("pintarBoton");
            document.getElementById("b5").classList.add("pintarBoton");
            document.getElementById("b9").classList.add("pintarBoton");
          } else if (gano8) {
            document.getElementById("b3").classList.add("pintarBoton");
            document.getElementById("b5").classList.add("pintarBoton");
            document.getElementById("b7").classList.add("pintarBoton");
          }
        }

        return ganoAlguien;
      }

      function verificarEnLinea(v1, v2, v3) {
        let resultado = false;
        if (v1 == v2 && v2 == v3) {
          if (v1 != "-") {
            resultado = true;
          }
        }

        return resultado;
      }

      function notificarGanador(turno) {
          var ganador;
          if(turno == "X") {
              ganador = '@ViewBag.Nombre1';
          } else {
              ganador = '@ViewBag.Nombre2';
          }
          return ganador;
      }




    </script>

    <style>
      button {
        height: 50px;
        width: 50px;
      }
    </style>
  </body>
}
